(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1:function(t,e,n){"use strict";n.d(e,"e",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"f",function(){return a}),n.d(e,"b",function(){return u}),n.d(e,"c",function(){return i}),n.d(e,"u",function(){return c}),n.d(e,"w",function(){return l}),n.d(e,"l",function(){return s}),n.d(e,"p",function(){return f}),n.d(e,"s",function(){return d}),n.d(e,"t",function(){return m}),n.d(e,"r",function(){return p}),n.d(e,"n",function(){return g}),n.d(e,"o",function(){return h}),n.d(e,"m",function(){return b}),n.d(e,"a",function(){return S}),n.d(e,"q",function(){return y}),n.d(e,"k",function(){return v}),n.d(e,"v",function(){return E}),n.d(e,"x",function(){return O}),n.d(e,"i",function(){return I}),n.d(e,"j",function(){return D}),n.d(e,"g",function(){return T}),n.d(e,"h",function(){return _});var r="AUTH_START",o="AUTH_READY",a="AUTH_SUCCESS",u="AUTH_FAIL",i="AUTH_LOGOUT",c="SET_AUTH_REDIRECT_PATH",l="SOURCE_UPDATE",s="DESTINATION_UPDATE",f="JOURNEY_DATE_UPDATE",d="SEARCH_BUSES_START",m="SEARCH_BUSES_SUCCESS",p="SEARCH_BUSES_FAIL",g="FETCH_BOOKINGS_START",h="FETCH_BOOKINGS_SUCCESS",b="FETCH_BOOKINGS_FAIL",S="ADD_SEAT",y="REMOVE_SEAT",v="CHANGE_TOTAL_SEATS",E="SET_FIELD",O="UPDATE_TOTAL_PRICE",I="BOOKING_START",D="BOOKING_SUCCESS",T="BOOKING_FAIL",_="BOOKING_INIT"},10:function(t,e,n){"use strict";var r=n(23),o=n.n(r).a.create({baseURL:"http://localhost:3002/"});e.a=o},30:function(t,e,n){"use strict";var r=n(1),o=n(23),a=n.n(o),u=n(44),i=n.n(u),c=function(){return{type:r.e}},l=function(){return{type:r.d}},s=function(t,e,n,o){return{type:r.f,token:t,userId:e,name:n,email:o}},f=function(){return localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),localStorage.removeItem("userId"),localStorage.removeItem("email"),{type:r.c}},d=function(t){return function(e){setTimeout(function(){e(f())},1e3*t)}},m=function(t,e,n,o,u,l){return function(f){f(c());var m={email:t,password:e},p="http://localhost:3002/user/login";l&&(p="http://localhost:3002/user/register",m={email:t,password:e,name:o.trim()+" "+u.trim(),phoneNumber:n}),a.a.post(p,m).then(function(t){var e=new Date((new Date).getTime()+1e3*t.data.expiresIn),n=i()(t.data.token.split(" ")[1]);localStorage.setItem("token",t.data.token),localStorage.setItem("expirationDate",e),localStorage.setItem("userId",n.id),localStorage.setItem("name",n.name),localStorage.setItem("email",n.email),f(s(t.data.token,n.id,n.name,n.email)),f(d(t.data.expiresIn))}).catch(function(t){var e;f((e=t,{type:r.b,error:e}))})}},p=function(){return function(t){var e=localStorage.getItem("token");if(e){var n=new Date(localStorage.getItem("expirationDate"));if(n<=new Date)t(f());else{var r=localStorage.getItem("userId"),o=localStorage.getItem("name"),a=localStorage.getItem("email");t(s(e,r,o,a))}t(d((n.getTime()-(new Date).getTime())/1e3))}else t(f())}},g=(n(21),n(10));var h=function(t,e,n,o,a){return{type:r.v,busId:t,source:e,destination:n,journeyDate:o,basePrice:a}},b=function(){return{type:r.a}},S=function(){return{type:r.q}},y=function(t){return{type:r.k,totalSeats:t}},v=function(){return{type:r.x}},E=function(t){return function(e){g.a.post("/bookings/new",t).then(function(t){var n;e((n=t.data,{type:r.j,bookingData:n}))}).catch(function(t){e({type:r.g})})}},O=function(){return function(t){t({type:r.n}),g.a.get("/bookings/old").then(function(e){var n;t((n=e.data.bookings,{type:r.o,bookings:n}))}).catch(function(e){t({type:r.m})})}},I=function(t){return{type:r.w,source:t}},D=function(t){return{type:r.l,destination:t}},T=function(t){return{type:r.p,journeyDate:t}},_=function(t){return{type:r.r,error:t}},j=function(){return{type:r.s}},k=function(t){return function(e){e(j()),g.a.post("/bus/search",t).then(function(t){var n;t.data.buses?e((n=t.data.buses,{type:r.t,searchData:n})):e(_(t.data.error))}).catch(function(t){console.log(t),e(_(t))})}};n.d(e,"e",function(){return m}),n.d(e,"l",function(){return f}),n.d(e,"f",function(){return p}),n.d(e,"h",function(){return c}),n.d(e,"g",function(){return l}),n.d(e,"k",function(){return O}),n.d(e,"i",function(){return E}),n.d(e,"p",function(){return h}),n.d(e,"c",function(){return b}),n.d(e,"m",function(){return S}),n.d(e,"j",function(){return y}),n.d(e,"q",function(){return v}),n.d(e,"n",function(){return k}),n.d(e,"a",function(){return D}),n.d(e,"d",function(){return I}),n.d(e,"b",function(){return T}),n.d(e,"o",function(){return j})},31:function(t,e,n){"use strict";var r=n(0),o=n.n(r),a=n(45),u=n.n(a);e.a=function(){return o.a.createElement("div",{className:u.a.loader},"Loading...")}},45:function(t,e,n){t.exports={loader:"Spinner_loader__MhRO0",load6:"Spinner_load6__1ceB7",round:"Spinner_round__2D0Tg"}},48:function(t,e,n){t.exports=n(77)},76:function(t,e,n){},77:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),a=n(20),u=n.n(a),i=n(1),c=n(21);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}var s=function(t,e){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(n,!0).forEach(function(e){Object(c.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t,{},e)},f={source:"",destination:"",journeyDate:"",searchData:"",loading:!1,error:""},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case i.w:return function(t,e){var n=e.source;return s(t,{source:n})}(t,e);case i.l:return function(t,e){var n=e.destination;return s(t,{destination:n})}(t,e);case i.p:return function(t,e){var n=e.journeyDate;return s(t,{journeyDate:n})}(t,e);case i.t:return function(t,e){var n=e.searchData;return s(t,{searchData:n,loading:!1,error:""})}(t,e);case i.r:return function(t,e){var n={source:"",destination:"",journeyDate:"",searchData:"",loading:!1,error:e.error};return s(t,n)}(t,e);case i.s:return function(t,e){return s(t,{source:"",destination:"",journeyDate:"",searchData:"",loading:!0,error:""})}(t);default:return t}},m={token:null,userId:null,name:"",email:"",error:null,authRedirectPath:"",loading:!1},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case i.e:return function(t,e){return s(t,{error:null,loading:!0})}(t);case i.d:return function(t,e){return s(t,{error:null,loading:!1})}(t);case i.f:return function(t,e){return s(t,{token:e.token,userId:e.userId,name:e.name,email:e.email,error:null})}(t,e);case i.b:return function(t,e){return s(t,{error:e.error,loading:!1})}(t,e);case i.c:return function(t,e){return s(t,{token:null,userId:null,name:null,email:null})}(t);case i.u:return function(t,e){return s(t,{authRedirectPath:e.path})}(t,e);default:return t}},g={source:"",destination:"",journeyDate:"",totalSeats:"",totalPrice:0,basePrice:0,booked:!1,loading:!1,bookings:[],busId:""},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case i.a:return function(t,e){return s(t,{totalSeats:Number(t.totalSeats)+1})}(t);case i.q:return function(t,e){return s(t,{totalSeats:Number(t.totalSeats)-1})}(t);case i.k:return function(t,e){return s(t,{totalSeats:Number(e.totalSeats)})}(t,e);case i.x:return function(t,e){return s(t,{totalPrice:t.totalSeats*t.basePrice})}(t);case i.v:return function(t,e){var n=e.journeyDate.split("-"),r=[n[2],n[1],n[0]].join("-"),o={busId:e.busId,source:e.source,destination:e.destination,journeyDate:r,basePrice:e.basePrice};return s(t,o)}(t,e);case i.i:return function(t,e){return s(t,{loading:!0,booked:!1})}(t);case i.j:return function(t,e){var n=e.bookingData;return s(t,{loading:!1,booked:!0,source:"",destination:"",journeyDate:"",totalSeats:"",totalPrice:0,basePrice:0,busId:"",bookings:t.booking.concat(n)})}(t,e);case i.g:return function(t,e){return s(t,{loading:!1})}(t);case i.n:return function(t,e){return s(t,{loading:!0})}(t);case i.o:return function(t,e){return s(t,{bookings:e.bookings,loading:!1})}(t,e);case i.m:return function(t,e){return s(t,{loading:!1})}(t);default:return t}},b=n(24),S=n(42),y=n(19),v=n(12),E=n(14),O=n(15),I=n(17),D=n(16),T=n(18),_=n(11),j=n(30),k=n(10),A=function(){var t=localStorage.getItem("token");t?k.a.defaults.headers.common.Authorization=t:delete k.a.defaults.headers.common.Authorization},w=n(31),P=function(t){return function(e){function n(){var t,e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=Object(I.a)(this,(t=Object(D.a)(n)).call.apply(t,[this].concat(o)))).state={component:null},e}return Object(T.a)(n,e),Object(O.a)(n,[{key:"componentDidMount",value:function(){var e=this;t().then(function(t){e.setState({component:t.default})})}},{key:"render",value:function(){var t=this.state.component;return t?o.a.createElement(t,this.props):null}}]),n}(r.Component)},C=P(function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,99))}),U=P(function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,98))}),R=P(function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,100))}),N=P(function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,101))}),H=function(t){function e(){var t,n;Object(E.a)(this,e);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(I.a)(this,(t=Object(D.a)(e)).call.apply(t,[this].concat(o)))).state={loading:!0},n}return Object(T.a)(e,t),Object(O.a)(e,[{key:"componentDidMount",value:function(){var t=this;setTimeout(function(){return t.setState({loading:!1})},1700),this.props.onTryAutoSignUp(),A()}},{key:"render",value:function(){var t={main:{top:"50%",right:"50%",transform:"translate(50%,-50%)"},loadingContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh"}},e=o.a.createElement("div",{style:t.loadingContainer},o.a.createElement(w.a,{style:t.main}),o.a.createElement("h3",{style:{color:"#ed3330"}},"Loading...")),n=o.a.createElement(_.c,null,o.a.createElement(_.a,{path:"/search",component:this.state.loading?function(){return e}:C}),o.a.createElement(_.a,{path:"/",component:this.state.loading?function(){return e}:U}));return this.props.isAuthenticated&&(n=o.a.createElement(_.c,null,o.a.createElement(_.a,{path:"/showbookings",component:N}),o.a.createElement(_.a,{path:"/booknow/:id",component:this.state.loading?function(){return e}:R}),o.a.createElement(_.a,{path:"/search",component:this.state.loading?function(){return e}:C}),o.a.createElement(_.a,{path:"/",exact:!0,component:this.state.loading?function(){return e}:U}))),o.a.createElement("div",null,o.a.createElement(_.c,null,n))}}]),e}(r.Component),x=Object(_.f)(Object(y.b)(function(t){return{isAuthenticated:null!==t.auth.token}},function(t){return{onTryAutoSignUp:function(){return t(j.f())}}})(H)),B=(n(76),v.d),L=Object(v.c)({auth:p,search:d,booking:h}),G=Object(v.e)(L,B(Object(v.a)(S.a)));A(),document.body.style.margin=0,document.body.style.padding=0;var F=o.a.createElement(y.a,{store:G},o.a.createElement(b.a,{basename:"/MoSeat"},o.a.createElement(x,null))),K=document.getElementById("root");u.a.render(F,K)}},[[48,2,3]]]);
//# sourceMappingURL=main.19db1798.chunk.js.map